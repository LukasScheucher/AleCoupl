close all
clear
clc


%% create geometry
setup

%plot geometry
f_frame=figure()
hold on
axis equal
axis off

plotframe(f_frame,1,ele.mbody,nodes.mbody,geo.master.disp)
plotframe(f_frame,1,ele.sbody,nodes.sbody,geo.slave.disp)

%% Determine the overlap
[geo.snode2mele,geo.mnode2sele,geo.ilagele,geo.ilagnodes,]=DetectOverlap(ele,nodes,geo)

plotOverlap(f_frame,ele,nodes,geo)


geo.nummdof=geo.master.numnodetot*2;
geo.numsdof=geo.slave. numnodetot*2;
geo.numldof=length(geo.ilagnodes)*2;

geo.syssize=geo.nummdof+geo.numsdof+geo.numldof;

[D,M]=genCoupl(geo,ele,nodes);


P=inv(D)*M

%% TODO Apply the displacement her

geo.slave.disp =ones(geo.nummdof)*0.2;
geo.master.disp=P*dispm